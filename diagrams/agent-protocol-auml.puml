@startuml
title AUML Protocol - Multi-Agent Debate

autonumber
skinparam sequenceMessageAlign center

participant "Orchestrator\n<<agent>>" as Orchestrator
participant "ContentAnalyzer\n<<agent>>" as Content
participant "SecurityValidator\n<<agent>>" as Security
participant "SocialContextEvaluator\n<<agent>>" as Social
participant "VotingAggregator\n<<agent>>" as Aggregator

Orchestrator -> Aggregator : init_debate()
par Round 1 (parallel analyze)
  Orchestrator -> Content : analyze(message, context, single_shot)
  Orchestrator -> Security : analyze(message, context, single_shot)
  Orchestrator -> Social : analyze(message, context, single_shot)
end
Content --> Orchestrator : vote + args
Security --> Orchestrator : vote + args
Social --> Orchestrator : vote + args

Orchestrator -> Aggregator : check_consensus(votes)

alt Consensus reached
  Orchestrator -> Aggregator : aggregate(round1, none)
else No consensus
  Orchestrator -> Content : deliberate(peers)
  Orchestrator -> Security : deliberate(peers)
  Orchestrator -> Social : deliberate(peers)
  Content --> Orchestrator : revised vote
  Security --> Orchestrator : revised vote
  Social --> Orchestrator : revised vote
  Orchestrator -> Aggregator : aggregate(round1, round2)
end

Aggregator --> Orchestrator : final decision + confidence
@enduml
