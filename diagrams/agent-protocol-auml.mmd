sequenceDiagram
  participant Orchestrator as Orchestrator <<agent>>
  participant Content as ContentAnalyzer <<agent>>
  participant Security as SecurityValidator <<agent>>
  participant Social as SocialContextEvaluator <<agent>>
  participant Aggregator as VotingAggregator <<agent>>

  Orchestrator->>Aggregator: init_debate()
  par Round 1 (parallel analyze)
    Orchestrator->>Content: analyze(message, context, single_shot)
    Orchestrator->>Security: analyze(message, context, single_shot)
    Orchestrator->>Social: analyze(message, context, single_shot)
  end
  Content-->>Orchestrator: vote + args
  Security-->>Orchestrator: vote + args
  Social-->>Orchestrator: vote + args

  Orchestrator->>Aggregator: check_consensus(votes)
  alt Consensus reached
    Orchestrator->>Aggregator: aggregate(round1)
  else No consensus
    Orchestrator->>Content: deliberate(peers)
    Orchestrator->>Security: deliberate(peers)
    Orchestrator->>Social: deliberate(peers)
    Content-->>Orchestrator: revised vote
    Security-->>Orchestrator: revised vote
    Social-->>Orchestrator: revised vote
    Orchestrator->>Aggregator: aggregate(round1, round2)
  end

  Aggregator-->>Orchestrator: final decision + confidence
